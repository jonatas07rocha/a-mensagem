<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visualizador Web</title>
    
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#333333"/>

    <style>
        /* Estilos principais */
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            overflow: hidden;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
        }

        iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        /* --- Estilos do Guia de Instalação --- */

        /* Botão flutuante para abrir o guia (AGORA CENTRALIZADO) */
        #install-guide-btn {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%); /* Truque para centralização perfeita */
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 50px;
            padding: 12px 20px;
            font-size: 16px;
            font-weight: 500;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            cursor: pointer;
            z-index: 999;
            display: none; /* Começa oculto */
        }

        /* Fundo escuro do modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            z-index: 1000;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* Conteúdo do modal */
        .modal-content {
            background: white;
            padding: 25px;
            border-radius: 15px;
            max-width: 90%;
            width: 320px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            text-align: center;
        }

        .modal-content h3 {
            margin-top: 0;
            color: #333;
        }

        .modal-content p {
            color: #555;
            line-height: 1.5;
        }

        .modal-content .ios-share-icon {
            width: 28px;
            height: 28px;
            margin: 0 5px;
            vertical-align: middle;
        }

        /* Botão para fechar o modal */
        .close-btn {
            margin-top: 20px;
            background-color: #6c757d;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 10px 20px;
            cursor: pointer;
            font-size: 16px;
        }
        
        .hidden {
            display: none !important;
        }
    </style>
</head>
<body>

    <iframe src="https://biblia-a-mensagem.com/" title="Visualização do site Bíblia A Mensagem"></iframe>

    <!-- Botão flutuante que abre o guia -->
    <button id="install-guide-btn">Instalar App</button>

    <!-- Estrutura do Modal (invisível por padrão) -->
    <div id="install-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <h3>Como Instalar o App</h3>
            
            <!-- Instruções para iOS -->
            <div id="ios-guide" class="hidden">
                <p>1. Toque no ícone de <strong>Compartilhar</strong>
                    <svg class="ios-share-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50"><path d="M 25 2 C 23.90625 2 23 2.90625 23 4 L 23 23.3125 L 20.15625 20.46875 C 19.445313 19.757813 18.335938 19.757813 17.625 20.46875 C 16.914063 21.179688 16.914063 22.289063 17.625 23 L 24.28125 29.65625 C 24.65625 30.03125 25.34375 30.03125 25.71875 29.65625 L 32.375 23 C 33.085938 22.289063 33.085938 21.179688 32.375 20.46875 C 31.664063 19.757813 30.554688 19.757813 29.84375 20.46875 L 27 23.3125 L 27 4 C 27 2.90625 26.09375 2 25 2 Z M 8 33 C 6.90625 33 6 33.90625 6 35 L 6 42 C 6 43.09375 6.90625 44 8 44 L 42 44 C 43.09375 44 44 43.09375 44 42 L 44 35 C 44 33.90625 43.09375 33 42 33 C 40.90625 33 40 33.90625 40 35 L 40 40 L 10 40 L 10 35 C 10 33.90625 9.09375 33 8 33 Z"/></svg>
                   na barra do navegador.
                </p>
                <p>2. Deslize para cima e selecione <strong>"Adicionar à Tela de Início"</strong>.</p>
            </div>

            <!-- Instruções para Android -->
            <div id="android-guide" class="hidden">
                <p>1. Toque nos <strong>três pontinhos</strong> no canto superior do navegador.</p>
                <p>2. Selecione a opção <strong>"Instalar aplicativo"</strong> ou <strong>"Adicionar à tela inicial"</strong>.</p>
            </div>

            <button id="close-modal-btn" class="close-btn">Entendi</button>
        </div>
    </div>

    <script>
        // Registra o Service Worker (código PWA)
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('sw.js')
                    .then(reg => console.log('Service Worker registrado.', reg))
                    .catch(err => console.log('Erro no registro do Service Worker:', err));
            });
        }

        // Lógica do Guia de Instalação
        window.addEventListener('load', () => {
            const installBtn = document.getElementById('install-guide-btn');
            const modal = document.getElementById('install-modal');
            const closeModalBtn = document.getElementById('close-modal-btn');
            const iosGuide = document.getElementById('ios-guide');
            const androidGuide = document.getElementById('android-guide');

            // 1. Verifica se o app já está rodando em modo standalone (instalado)
            const isStandalone = window.matchMedia('(display-mode: standalone)').matches;

            // 2. Detecta o Sistema Operacional
            const userAgent = navigator.userAgent || navigator.vendor || window.opera;
            let os = 'other';
            if (/android/i.test(userAgent)) {
                os = 'android';
            } else if (/iPad|iPhone|iPod/.test(userAgent) && !window.MSStream) {
                os = 'ios';
            }
            
            // 3. Mostra o botão e o guia correto se não estiver instalado
            if (!isStandalone) {
                if (os === 'ios') {
                    installBtn.style.display = 'block';
                    iosGuide.classList.remove('hidden');
                } else if (os === 'android') {
                    installBtn.style.display = 'block';
                    androidGuide.classList.remove('hidden');
                }
            }

            // 4. Funções para abrir e fechar o modal
            const openModal = () => modal.classList.remove('hidden');
            const closeModal = () => modal.classList.add('hidden');

            installBtn.addEventListener('click', openModal);
            closeModalBtn.addEventListener('click', closeModal);
            modal.addEventListener('click', (event) => {
                // Fecha o modal se o clique for no fundo escuro
                if (event.target === modal) {
                    closeModal();
                }
            });
        });
    </script>

</body>
</html>